[gd_resource type="BehaviorTree" load_steps=62 format=3 uid="uid://bc7ucld3pg5s8"]

[ext_resource type="Script" uid="uid://cx4cr5k5q32jh" path="res://entities/enemies/ai/tasks/get_target.gd" id="1_yhbkp"]
[ext_resource type="Script" uid="uid://c7xx8urep15p8" path="res://entities/enemies/ai/tasks/stop_movement.gd" id="2_6nkjl"]
[ext_resource type="Script" uid="uid://cnafxaxl4fat8" path="res://entities/enemies/ai/tasks/patrol.gd" id="2_t3gyd"]
[ext_resource type="Script" uid="uid://buntnywdkftvf" path="res://entities/enemies/ai/tasks/in_range.gd" id="2_wrjj1"]
[ext_resource type="Script" uid="uid://b4c1y5nqjinua" path="res://entities/enemies/ai/tasks/pounce.gd" id="3_b2ogj"]
[ext_resource type="Script" uid="uid://cb0vv4mt50hth" path="res://entities/enemies/ai/tasks/face.gd" id="3_yhbkp"]
[ext_resource type="Script" uid="uid://bhofui8vv8ddv" path="res://entities/enemies/ai/tasks/use_ability.gd" id="4_yhbkp"]
[ext_resource type="Script" uid="uid://wrawtm8at4do" path="res://entities/enemies/ai/tasks/dash.gd" id="6_k708t"]
[ext_resource type="Script" uid="uid://c45pbn6cvkrga" path="res://entities/enemies/ai/tasks/pursue.gd" id="8_k708t"]
[ext_resource type="Script" uid="uid://cij6ujjfigpjc" path="res://entities/enemies/ai/tasks/weapon_attack.gd" id="9_u4hmx"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_sfte8"]

[sub_resource type="BTAction" id="BTAction_wrjj1"]
script = ExtResource("1_yhbkp")
target_var = &"target"

[sub_resource type="BBNode" id="BBNode_ulmcl"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_40a5u"]
animation_player = SubResource("BBNode_ulmcl")
animation_name = &"Walk"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_ocp3w"]
script = ExtResource("2_t3gyd")
patrol_radius = 8.0
patrol_interval = 2.0
min_distance = 0.5
chaotic = true
wave_frequency = 2.0
wave_amplitude = 15.0

[sub_resource type="BTSequence" id="BTSequence_t3gyd"]
custom_name = "Patrol chaotically"
children = [SubResource("BTPlayAnimation_40a5u"), SubResource("BTAction_ocp3w")]

[sub_resource type="BBNode" id="BBNode_sq422"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_qmoh7"]
animation_player = SubResource("BBNode_sq422")
animation_name = &"Idle"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_k708t"]
script = ExtResource("2_6nkjl")

[sub_resource type="BTRandomWait" id="BTRandomWait_sq422"]
min_duration = 0.5
max_duration = 1.4

[sub_resource type="BTSequence" id="BTSequence_qmoh7"]
custom_name = "Pause before action"
children = [SubResource("BTPlayAnimation_qmoh7"), SubResource("BTAction_k708t"), SubResource("BTRandomWait_sq422")]

[sub_resource type="BBNode" id="BBNode_b2ogj"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_yhbkp"]
animation_player = SubResource("BBNode_b2ogj")
animation_name = &"Jump"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_4fcdy"]
script = ExtResource("3_yhbkp")
target_var = &"target"
rotation_speed = 6.0
angle_threshold = 25.0
duration = 0.0

[sub_resource type="BBNode" id="BBNode_k708t"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_u4hmx"]
animation_player = SubResource("BBNode_k708t")
animation_name = &"Fall"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_t3gyd"]
script = ExtResource("3_b2ogj")
target_var = &"target"
jump_factor = 2.2
horizontal_speed = 40.0
min_distance = 10.0

[sub_resource type="BTAction" id="BTAction_ulmcl"]
script = ExtResource("4_yhbkp")
target_var = &"target"
slot = 0

[sub_resource type="BTSequence" id="BTSequence_ulmcl"]
custom_name = "Pounce sequence"
children = [SubResource("BTPlayAnimation_yhbkp"), SubResource("BTAction_4fcdy"), SubResource("BTPlayAnimation_u4hmx"), SubResource("BTAction_t3gyd"), SubResource("BTAction_ulmcl")]
metadata/_weight_ = 1.0

[sub_resource type="BBNode" id="BBNode_t3gyd"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_ulmcl"]
animation_player = SubResource("BBNode_t3gyd")
animation_name = &"Dash"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_ca3xq"]
script = ExtResource("3_yhbkp")
target_var = &"target"
rotation_speed = 8.0
angle_threshold = 25.0
duration = 0.0

[sub_resource type="BTWait" id="BTWait_u4hmx"]
duration = 0.2

[sub_resource type="BTAction" id="BTAction_u4hmx"]
script = ExtResource("6_k708t")
target_var = &"target"
dash_duration = 0.2
dash_distance = 30.0

[sub_resource type="BTAction" id="BTAction_40a5u"]
script = ExtResource("4_yhbkp")
target_var = &"target"
slot = 1

[sub_resource type="BTSequence" id="BTSequence_40a5u"]
custom_name = "Dash sequence"
children = [SubResource("BTPlayAnimation_ulmcl"), SubResource("BTAction_ca3xq"), SubResource("BTWait_u4hmx"), SubResource("BTAction_u4hmx"), SubResource("BTAction_40a5u")]
metadata/_weight_ = 1.0

[sub_resource type="BTCondition" id="BTCondition_t3gyd"]
script = ExtResource("2_wrjj1")
target_var = &"target"
distance_min = 0.0
distance_max = 10.0

[sub_resource type="BTAction" id="BTAction_pbs4t"]
script = ExtResource("2_6nkjl")

[sub_resource type="BTComment" id="BTComment_ulmcl"]
custom_name = "TODO, add slash animation"

[sub_resource type="BBNode" id="BBNode_40a5u"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_4fcdy"]
animation_player = SubResource("BBNode_40a5u")
animation_name = &"Sprint"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_y7cob"]
script = ExtResource("3_yhbkp")
target_var = &"target"
rotation_speed = 6.0
angle_threshold = 25.0
duration = 0.0

[sub_resource type="BTAction" id="BTAction_8831e"]
script = ExtResource("4_yhbkp")
target_var = &"target"
slot = 2

[sub_resource type="BTSequence" id="BTSequence_pbs4t"]
children = [SubResource("BTAction_y7cob"), SubResource("BTAction_8831e")]

[sub_resource type="BTTimeLimit" id="BTTimeLimit_8k4wv"]
time_limit = 1.5
children = [SubResource("BTSequence_pbs4t")]

[sub_resource type="BTSequence" id="BTSequence_fhbfq"]
custom_name = "Slash sequence"
children = [SubResource("BTCondition_t3gyd"), SubResource("BTAction_pbs4t"), SubResource("BTComment_ulmcl"), SubResource("BTPlayAnimation_4fcdy"), SubResource("BTTimeLimit_8k4wv")]

[sub_resource type="BTProbabilitySelector" id="BTProbabilitySelector_b2ogj"]
children = [SubResource("BTSequence_ulmcl"), SubResource("BTSequence_40a5u"), SubResource("BTSequence_fhbfq")]

[sub_resource type="BTCondition" id="BTCondition_40a5u"]
script = ExtResource("2_wrjj1")
target_var = &"target"
distance_min = 0.0
distance_max = 50.0

[sub_resource type="BBNode" id="BBNode_qmoh7"]
saved_value = NodePath("ice_fox/AnimationPlayer")
resource_name = "ice_fox/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_wrjj1"]
animation_player = SubResource("BBNode_qmoh7")
animation_name = &"Sprint"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_fhbfq"]
script = ExtResource("3_yhbkp")
target_var = &"target"
rotation_speed = 6.0
angle_threshold = 0.0
duration = 0.0

[sub_resource type="BTAction" id="BTAction_nju8x"]
script = ExtResource("8_k708t")
target_var = &"target"
tolerance = 5.0
aggro_distance = 20.0
speed_factor = 0.0
duration = 0.0
stuck_interval = 1.0
stuck_threshold = 2.5

[sub_resource type="BTCondition" id="BTCondition_u4hmx"]
script = ExtResource("2_wrjj1")
target_var = &"target"
distance_min = 0.0
distance_max = 5.0

[sub_resource type="BTAction" id="BTAction_uxecv"]
script = ExtResource("9_u4hmx")
target_var = &"target"

[sub_resource type="BTWait" id="BTWait_t3gyd"]
duration = 0.5

[sub_resource type="BTSequence" id="BTSequence_4fcdy"]
custom_name = "Melee attack"
children = [SubResource("BTCondition_u4hmx"), SubResource("BTAction_uxecv"), SubResource("BTWait_t3gyd")]

[sub_resource type="BTRepeat" id="BTRepeat_ocp3w"]
forever = true
children = [SubResource("BTSequence_4fcdy")]

[sub_resource type="BTParallel" id="BTParallel_yhbkp"]
children = [SubResource("BTAction_fhbfq"), SubResource("BTAction_nju8x"), SubResource("BTRepeat_ocp3w")]

[sub_resource type="BTTimeLimit" id="BTTimeLimit_b2ogj"]
time_limit = 10.0
children = [SubResource("BTParallel_yhbkp")]

[sub_resource type="BTSequence" id="BTSequence_wrjj1"]
custom_name = "Pursue target"
children = [SubResource("BTCondition_40a5u"), SubResource("BTPlayAnimation_wrjj1"), SubResource("BTTimeLimit_b2ogj")]

[sub_resource type="BTSequence" id="BTSequence_sq422"]
children = [SubResource("BTAction_wrjj1"), SubResource("BTSequence_t3gyd"), SubResource("BTSequence_qmoh7"), SubResource("BTProbabilitySelector_b2ogj"), SubResource("BTSequence_wrjj1")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_sfte8")
root_task = SubResource("BTSequence_sq422")
