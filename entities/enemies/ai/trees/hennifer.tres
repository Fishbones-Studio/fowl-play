[gd_resource type="BehaviorTree" load_steps=90 format=3 uid="uid://cjwfnys8g6i4y"]

[ext_resource type="Script" uid="uid://cx4cr5k5q32jh" path="res://entities/enemies/ai/tasks/get_target.gd" id="1_8in54"]
[ext_resource type="Script" uid="uid://h0nq32ajrxy5" path="res://entities/enemies/ai/tasks/player_on_top.gd" id="2_sxcr3"]
[ext_resource type="Script" uid="uid://cgid2hgg4itoh" path="res://entities/enemies/ai/tasks/target_height.gd" id="3_v6hs5"]
[ext_resource type="Script" uid="uid://cfp1o30pt8yx7" path="res://entities/enemies/ai/tasks/flank.gd" id="4_kpifs"]
[ext_resource type="Script" uid="uid://c0y08orvf36q3" path="res://entities/enemies/ai/tasks/current_health.gd" id="5_hvnwj"]
[ext_resource type="Script" uid="uid://v88ofxynokd3" path="res://entities/enemies/ai/tasks/stuck.gd" id="6_7xuyr"]
[ext_resource type="Script" uid="uid://c7xx8urep15p8" path="res://entities/enemies/ai/tasks/stop_movement.gd" id="7_b566n"]
[ext_resource type="Script" uid="uid://cb0vv4mt50hth" path="res://entities/enemies/ai/tasks/face.gd" id="8_g1hyr"]
[ext_resource type="Script" uid="uid://c45pbn6cvkrga" path="res://entities/enemies/ai/tasks/pursue.gd" id="9_4he0i"]
[ext_resource type="Script" uid="uid://buntnywdkftvf" path="res://entities/enemies/ai/tasks/in_range.gd" id="10_ikecd"]
[ext_resource type="Script" uid="uid://cij6ujjfigpjc" path="res://entities/enemies/ai/tasks/use_weapon.gd" id="11_augj3"]
[ext_resource type="Script" uid="uid://be6ck8w34nf3g" path="res://entities/enemies/ai/tasks/jump.gd" id="12_bwioj"]
[ext_resource type="Script" uid="uid://b6rfb6o4174xn" path="res://entities/enemies/ai/tasks/retreat.gd" id="13_l7wqg"]
[ext_resource type="PackedScene" uid="uid://c1kqvn5lvj320" path="res://level/arena/props/hazards/egg_bomb/egg_bomb.tscn" id="14_t8vjl"]
[ext_resource type="Script" uid="uid://ddx836816k8ju" path="res://entities/enemies/ai/tasks/spawn_hazard.gd" id="15_shlr8"]
[ext_resource type="Script" uid="uid://bufx3c4udrfdq" path="res://entities/enemies/ai/tasks/stunned.gd" id="16_j3tue"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_8swpl"]

[sub_resource type="BTAction" id="BTAction_lg466"]
script = ExtResource("1_8in54")
target_var = &"target"

[sub_resource type="BTCondition" id="BTCondition_mnhi0"]
script = ExtResource("2_sxcr3")
check_distance = 7.0
player_layer = 2

[sub_resource type="BTCondition" id="BTCondition_wv527"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 4
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTCondition" id="BTCondition_viady"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 3
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTParallel" id="BTParallel_504pj"]
num_failures_required = 3
children = [SubResource("BTCondition_mnhi0"), SubResource("BTCondition_wv527"), SubResource("BTCondition_viady")]

[sub_resource type="BTAction" id="BTAction_fxtff"]
script = ExtResource("4_kpifs")
target_var = &"target"
flank_distance = 2.0
vertical_offset = 0.0
clearance_radius = 0.5
telegraph_timer = null

[sub_resource type="BTSequence" id="BTSequence_k4t8y"]
children = [SubResource("BTParallel_504pj"), SubResource("BTAction_fxtff")]

[sub_resource type="BTCondition" id="BTCondition_504pj"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 3
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTInvert" id="BTInvert_wv527"]
children = [SubResource("BTCondition_504pj")]

[sub_resource type="BTCondition" id="BTCondition_k7lfl"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 4
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTInvert" id="BTInvert_a51uw"]
children = [SubResource("BTCondition_k7lfl")]

[sub_resource type="BTCondition" id="BTCondition_gvblq"]
script = ExtResource("5_hvnwj")
comparison = 4
threshold = 30.0
use_percentage = true

[sub_resource type="BTRepeatUntilFailure" id="BTRepeatUntilFailure_gvblq"]
children = [SubResource("BTCondition_gvblq")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_wv527"]
children = [SubResource("BTRepeatUntilFailure_gvblq")]

[sub_resource type="BTCondition" id="BTCondition_cofkk"]
script = ExtResource("6_7xuyr")
stuck_interval = 1.0
stuck_threshold = 2.5

[sub_resource type="BTRepeatUntilFailure" id="BTRepeatUntilFailure_wv527"]
children = [SubResource("BTCondition_cofkk")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_5c880"]
children = [SubResource("BTRepeatUntilFailure_wv527")]

[sub_resource type="BTCondition" id="BTCondition_5c880"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 4
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTRepeatUntilSuccess" id="BTRepeatUntilSuccess_viady"]
children = [SubResource("BTCondition_5c880")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_k7lfl"]
children = [SubResource("BTRepeatUntilSuccess_viady")]

[sub_resource type="BTCondition" id="BTCondition_dbsnm"]
script = ExtResource("3_v6hs5")
target_var = &"target"
comparison = 3
height_threshold = 4.5
use_relative = true
target_on_floor = true

[sub_resource type="BTRepeatUntilSuccess" id="BTRepeatUntilSuccess_cgerr"]
children = [SubResource("BTCondition_dbsnm")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_cofkk"]
children = [SubResource("BTRepeatUntilSuccess_cgerr")]

[sub_resource type="BBNode" id="BBNode_5c880"]
saved_value = NodePath("Model/chicken_hennifer/AnimationPlayer")
resource_name = "Model/chicken_hennifer/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_504pj"]
animation_player = SubResource("BBNode_5c880")
animation_name = &"Idle"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_wv527"]
script = ExtResource("7_b566n")
min_wait_time = 0.3
max_wait_time = 0.5

[sub_resource type="BTSequence" id="BTSequence_k7lfl"]
custom_name = "Pause before action"
children = [SubResource("BTPlayAnimation_504pj"), SubResource("BTAction_wv527")]

[sub_resource type="BBNode" id="BBNode_504pj"]
saved_value = NodePath("Model/chicken_hennifer/AnimationPlayer")
resource_name = "Model/chicken_hennifer/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_dbsnm"]
animation_player = SubResource("BBNode_504pj")
animation_name = &"Walking"
blend = 0.2
speed = 2.0
from_end = true

[sub_resource type="BTAction" id="BTAction_cgerr"]
script = ExtResource("8_g1hyr")
target_var = &"target"
rotation_speed = 10.0
angle_threshold = 5.0
duration = 0.0
face_away = false

[sub_resource type="BTAction" id="BTAction_f2bow"]
script = ExtResource("9_4he0i")
target_var = &"target"
tolerance = 5.0
speed_factor = 0.0
duration = 10.0
ignore_y = true
pathfinding = true
immediate_response = true
path_update_interval = 0.05

[sub_resource type="BTCondition" id="BTCondition_yoxl1"]
script = ExtResource("10_ikecd")
target_var = &"target"
distance_min = 0.0
distance_max = 5.0

[sub_resource type="BTAction" id="BTAction_pyqya"]
script = ExtResource("11_augj3")
ignore_cooldown = false
start_state = 1

[sub_resource type="BTSequence" id="BTSequence_xlk6v"]
children = [SubResource("BTCondition_yoxl1"), SubResource("BTAction_pyqya")]

[sub_resource type="BTParallel" id="BTParallel_qjxos"]
num_successes_required = 2
num_failures_required = 2
repeat = true
children = [SubResource("BTAction_cgerr"), SubResource("BTAction_f2bow"), SubResource("BTSequence_xlk6v")]

[sub_resource type="BTSequence" id="BTSequence_504pj"]
children = [SubResource("BTSequence_k7lfl"), SubResource("BTPlayAnimation_dbsnm"), SubResource("BTParallel_qjxos")]

[sub_resource type="BTParallel" id="BTParallel_viady"]
children = [SubResource("BTAlwaysFail_wv527"), SubResource("BTAlwaysFail_5c880"), SubResource("BTAlwaysFail_k7lfl"), SubResource("BTAlwaysFail_cofkk"), SubResource("BTSequence_504pj")]

[sub_resource type="BTSequence" id="BTSequence_lsbnu"]
custom_name = "Pursue"
children = [SubResource("BTInvert_wv527"), SubResource("BTInvert_a51uw"), SubResource("BTParallel_viady")]
metadata/_weight_ = 5.0

[sub_resource type="BBNode" id="BBNode_viady"]
saved_value = NodePath("Model/chicken_hennifer/AnimationPlayer")
resource_name = "Model/chicken_hennifer/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_a51uw"]
animation_player = SubResource("BBNode_viady")
animation_name = &"Idle"
blend = 0.3

[sub_resource type="BTAction" id="BTAction_dbsnm"]
script = ExtResource("7_b566n")
min_wait_time = 0.0
max_wait_time = 0.0

[sub_resource type="BTRandomWait" id="BTRandomWait_cgerr"]
min_duration = 0.7
max_duration = 1.5

[sub_resource type="BTSequence" id="BTSequence_cofkk"]
custom_name = "Pause before action"
children = [SubResource("BTPlayAnimation_a51uw"), SubResource("BTAction_dbsnm"), SubResource("BTRandomWait_cgerr")]

[sub_resource type="BTAction" id="BTAction_gvblq"]
script = ExtResource("12_bwioj")
jump_factor = 1.0
duration = 0.0
is_falling = false
has_landed = false
reached_peak = true

[sub_resource type="BTSequence" id="BTSequence_wv527"]
custom_name = "Anticipation"
children = [SubResource("BTAction_gvblq")]

[sub_resource type="BBNode" id="BBNode_k7lfl"]
saved_value = NodePath("Model/chicken_hennifer/AnimationPlayer")
resource_name = "Model/chicken_hennifer/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_l0rnk"]
animation_player = SubResource("BBNode_k7lfl")
animation_name = &"Dash"
blend = 0.2
speed = 6.0

[sub_resource type="BTAction" id="BTAction_n7fk8"]
script = ExtResource("4_kpifs")
target_var = &"target"
flank_distance = 2.0
vertical_offset = 0.0
clearance_radius = 1.0
telegraph_timer = null

[sub_resource type="BTSequence" id="BTSequence_6e6ua"]
custom_name = "Flank"
children = [SubResource("BTPlayAnimation_l0rnk"), SubResource("BTAction_n7fk8")]

[sub_resource type="BTWait" id="BTWait_i6i68"]
duration = 0.1

[sub_resource type="BTAction" id="BTAction_hcbj7"]
script = ExtResource("11_augj3")
ignore_cooldown = true
start_state = 1

[sub_resource type="BTDelay" id="BTDelay_n7fk8"]
seconds = 0.1
children = [SubResource("BTAction_hcbj7")]

[sub_resource type="BTRepeat" id="BTRepeat_vidql"]
times = 5
children = [SubResource("BTDelay_n7fk8")]

[sub_resource type="BTAction" id="BTAction_qjixf"]
script = ExtResource("8_g1hyr")
target_var = &"target"
rotation_speed = 2.0
angle_threshold = 2.0
duration = 0.0
face_away = false

[sub_resource type="BTParallel" id="BTParallel_hcbj7"]
children = [SubResource("BTRepeat_vidql"), SubResource("BTAction_qjixf")]

[sub_resource type="BTSequence" id="BTSequence_qjixf"]
custom_name = "Shank"
children = [SubResource("BTWait_i6i68"), SubResource("BTParallel_hcbj7")]

[sub_resource type="BTSequence" id="BTSequence_kwr7b"]
custom_name = "Flank and shank"
children = [SubResource("BTSequence_cofkk"), SubResource("BTSequence_wv527"), SubResource("BTSequence_6e6ua"), SubResource("BTSequence_qjixf")]
metadata/_weight_ = 1.0

[sub_resource type="BTCondition" id="BTCondition_f2bow"]
script = ExtResource("5_hvnwj")
comparison = 0
threshold = 30.0
use_percentage = true

[sub_resource type="BBNode" id="BBNode_a51uw"]
saved_value = NodePath("Model/chicken_hennifer/AnimationPlayer")
resource_name = "Model/chicken_hennifer/AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_schhj"]
animation_player = SubResource("BBNode_a51uw")
animation_name = &"Walking"
blend = 0.2
speed = 2.0

[sub_resource type="BTAction" id="BTAction_mnhi0"]
script = ExtResource("13_l7wqg")
target_var = &"target"
retreat_distance = 50.0
speed_factor = 0.0
rotation_speed = 6.0
duration = 10.0
pathfinding = true
immediate_response = true
path_update_interval = 0.05
face_moving_direction = true

[sub_resource type="BTAction" id="BTAction_504pj"]
script = ExtResource("15_shlr8")
hazard_resource = ExtResource("14_t8vjl")

[sub_resource type="BTDelay" id="BTDelay_viady"]
children = [SubResource("BTAction_504pj")]

[sub_resource type="BTParallel" id="BTParallel_5c880"]
num_successes_required = 2
repeat = true
children = [SubResource("BTAction_mnhi0"), SubResource("BTDelay_viady")]

[sub_resource type="BTSequence" id="BTSequence_pia2r"]
custom_name = "Retreat"
children = [SubResource("BTCondition_f2bow"), SubResource("BTPlayAnimation_schhj"), SubResource("BTParallel_5c880")]
metadata/_weight_ = 1.0

[sub_resource type="BTProbabilitySelector" id="BTProbabilitySelector_ptrup"]
children = [SubResource("BTSequence_lsbnu"), SubResource("BTSequence_kwr7b"), SubResource("BTSequence_pia2r")]

[sub_resource type="BTCondition" id="BTCondition_a51uw"]
script = ExtResource("16_j3tue")

[sub_resource type="BTRepeatUntilFailure" id="BTRepeatUntilFailure_dbsnm"]
children = [SubResource("BTCondition_a51uw")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_cgerr"]
children = [SubResource("BTRepeatUntilFailure_dbsnm")]

[sub_resource type="BTParallel" id="BTParallel_cofkk"]
children = [SubResource("BTProbabilitySelector_ptrup"), SubResource("BTAlwaysFail_cgerr")]

[sub_resource type="BTParallel" id="BTParallel_xlk6v"]
num_failures_required = 2
repeat = true
children = [SubResource("BTSequence_k4t8y"), SubResource("BTParallel_cofkk")]

[sub_resource type="BTSequence" id="BTSequence_t2uqu"]
children = [SubResource("BTAction_lg466"), SubResource("BTParallel_xlk6v")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_8swpl")
root_task = SubResource("BTSequence_t2uqu")
